function renderRepaymentSchedule(goalAmount) {
  const tbody = document.querySelector("#repaymentScheduleTable tbody");
  tbody.innerHTML = "";

  const allRecords = loadRecords().map(rec => ({
    date: new Date(rec.date),
    amount: rec.amount
  }));

  let start = new Date(2025, 8); // 9月（0-indexed）
  let remaining = goalAmount;
  let cumulativePlanned = 0;
  let cumulativeActual = 0;

  for (let i = 0; i < 60 && remaining > 0; i++) {
    const year = start.getFullYear();
    const month = start.getMonth() + 1;

    // 予定返済額
    let planned = 40000;
    if (month === 6 || month === 12) planned += 300000;

    if (planned > remaining) planned = remaining;
    cumulativePlanned += planned;
    remaining -= planned;

    // 実績：該当月の入金合計
    const monthlyActual = allRecords
      .filter(r => r.date.getFullYear() === year && r.date.getMonth() === start.getMonth())
      .reduce((sum, r) => sum + r.amount, 0);

    cumulativeActual += monthlyActual;

    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${year}年${String(month).padStart(2, '0')}月</td>
      <td>${planned.toLocaleString()}</td>
      <td>${cumulativePlanned.toLocaleString()}</td>
      <td style="font-weight: bold; color: darkblue;">${monthlyActual.toLocaleString()}</td>
      <td style="font-weight: bold; color: darkblue;">${cumulativeActual.toLocaleString()}</td>
      <td>${Math.max(goalAmount - cumulativePlanned, 0).toLocaleString()}</td>
    `;

    tbody.appendChild(row);
    start.setMonth(start.getMonth() + 1);
  }
}
